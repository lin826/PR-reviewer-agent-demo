--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,6 +1095,14 @@
             rcParams.update(rc)
         yield
     finally:
+        # If the backend was auto-resolved during this context (from _auto_backend_sentinel
+        # to a concrete backend), don't restore it to the sentinel. This prevents
+        # subsequent get_backend() calls from triggering switch_backend() and closing figures.
+        if (orig.get('backend') is rcsetup._auto_backend_sentinel and
+            dict.__getitem__(rcParams, 'backend') is not rcsetup._auto_backend_sentinel):
+            # Backend was auto-resolved, so preserve the resolved backend
+            orig = orig.copy()
+            orig['backend'] = dict.__getitem__(rcParams, 'backend')
         dict.update(rcParams, orig)  # Revert to the original rcs.
 
 

issues
- delayed import
- not abstracting out common functionality
- not using `skip_subtrees`, leading to a bunch of extra code (?)
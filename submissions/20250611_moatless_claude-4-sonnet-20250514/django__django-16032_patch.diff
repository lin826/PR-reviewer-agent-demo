--- a/django/db/models/lookups.py
+++ b/django/db/models/lookups.py
@@ -420,7 +420,7 @@
 
         if isinstance(self.rhs, Query):
             self.rhs.clear_ordering(clear_default=True)
-            if not self.rhs.has_select_fields:
+            if not self.rhs.has_explicit_select_fields:
                 self.rhs.clear_select_clause()
                 self.rhs.add_fields(["pk"])
         return super().get_prep_lookup()

--- a/django/db/models/sql/query.py
+++ b/django/db/models/sql/query.py
@@ -267,6 +267,18 @@
     def has_select_fields(self):
         return bool(
             self.select or self.annotation_select_mask or self.extra_select_mask
+        )
+
+    @property
+    def has_explicit_select_fields(self):
+        """
+        Check if the query has explicit field selections that should be preserved
+        in subqueries (for __in lookups). This excludes auto-selected annotations
+        from .annotate() calls that don't have corresponding .values() calls.
+        """
+        return bool(
+            self.select or self.extra_select_mask or
+            getattr(self, '_has_explicit_field_selection', False)
         )
 
     @cached_property
@@ -2384,6 +2396,9 @@
         self.select_related = False
         self.clear_deferred_loading()
         self.clear_select_fields()
+        
+        # Mark that explicit field selection was used
+        self._has_explicit_field_selection = True
 
         if fields:
             field_names = []

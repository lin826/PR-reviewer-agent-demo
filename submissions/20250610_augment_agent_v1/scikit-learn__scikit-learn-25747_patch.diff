diff --git a/sklearn/utils/_set_output.py b/sklearn/utils/_set_output.py
index 335773c6a..9ae5219fb 100644
--- a/sklearn/utils/_set_output.py
+++ b/sklearn/utils/_set_output.py
@@ -53,14 +53,26 @@ def _wrap_in_pandas_container(
     pd = check_pandas_support("Setting output container to 'pandas'")
 
     if isinstance(data_to_wrap, pd.DataFrame):
         if columns is not None:
             data_to_wrap.columns = columns
-        if index is not None:
+        if index is not None and len(index) == len(data_to_wrap):
+            # Only set the index if it has the same length as the data
             data_to_wrap.index = index
         return data_to_wrap
 
+    # Check if data_to_wrap is a pandas Series or has a meaningful index
+    if hasattr(data_to_wrap, 'index') and index is not None:
+        # Only use the provided index if it has the same length as the data
+        # or if the data has a default RangeIndex
+        if (len(index) == len(data_to_wrap) or 
+            isinstance(getattr(data_to_wrap, 'index', None), pd.RangeIndex)):
+            return pd.DataFrame(data_to_wrap, index=index, columns=columns)
+        else:
+            # Use the existing index from the data
+            return pd.DataFrame(data_to_wrap, columns=columns)
+    
     return pd.DataFrame(data_to_wrap, index=index, columns=columns)
 
 
 def _get_output_config(method, estimator=None):
     """Get output config based on estimator and global configuration.
